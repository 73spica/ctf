from m1z0r3.crypro import *


e = 65537
n = 23377710160585068929761618506991996226542827370307182169629858568023543788780175313008507293451307895240053109844393208095341963888750810795999334637219913785780317641204067199776554612826093939173529500677723999107174626333341127815073405082534438012567142969114708624398382362018792541727467478404573610869661887188854467262618007499261337953423761782551432338613283104868149867800953840280656722019640237553189669977426208944252707288724850642450845754249981895191279748269118285047312864220756292406661460782844868432184013840652299561380626402855579897282032613371294445650368096906572685254142278651577097577263

trump5 = 15742105247958736958004859844860106392650529642491444791655288653059139800053206167023792876159338330811553994563264038797209523053486931817881299156223450837206775783069574776254654197337314541494064874054449749920216258529257414289049794126137529358458843274774718683434637726891822317083908587215429977340799931758155377373656742947190372216055450421108566287038161365843817023142180328035768992726841684537565155117632165969899505426984495819465218509929865350057283134017766501372618581237936784285588661088765130624093014320161531747074858737002260566015050922492437422682387506583350890218827504186050632600504

five = 18938431620064949405099081881389422411569506620645684785718437650149907701313939238017399264771270907473551575023831816899182480214946633959498312433619616816861526269114681215528914329791099013891595131862543300865871379621247867883669403120593815746911158013483346808195756730946735362037791985948842449343328484149265803462983935765047801620079220588638013959948297979415581591179722303271496129424130559547762467547913292325129340535450673107267746074776721093375970510983576513946461957148135755448610570645462794635156136176208419134557678284424568016798221633694322809374691561612990098051154456165773266086828

def main():
    global send_i
    remoteip = "trumptrump.pwn.republican"
    remoteport = 3609
    br = "\r\n"
    i = 0
    f = open("trump.jpg","r")
    pic_data = int(f.read().encode("hex"),16)
    tmp = pic_data % n
    # print tmp
    s,f = sock(remoteip,remoteport)
    data = read_until(f,">")
    print data
    # send_item = str(5)
    # send_item = str(tmp/5)
    send_item = str((trump5*five) % n)
    s.send(send_item+br)
    print send_item
    # data = read_until(f,"Here ya go, kid: ")
    # num = read_until(f)
    # num = int(num)
    # print "Test:",pow(num,e,n)
    # print num
    # print s.recv(9999)
    print read_until(f,"at it.\n")
    ans = read_until(f).strip()
    print ans
    # ans = "0"+ans
    f_write= open("ans.jpg","w")
    f_write.write(ans.decode("hex"))
    # print "-----------------------------------"
    s.close()
    f.close()
    # while True:
    #     if i>=1:
    #         break
    #     i+=1
    #     s,f = sock(remoteip,remoteport)
    #     data = read_until(f,">")
    #     print data
    #     send_item = str(i+1)
    #     s.send(send_item+br)
    #     print send_item
        # data = read_until(f,"Here ya go, kid: ")
        # num = read_until(f)
        # num = int(num)
        # print "Test:",pow(num,e,n)
        # print num
        # print s.recv(1024)
        # print "-----------------------------------"
        # s.close()
        # f.close()


if __name__ == '__main__':
    main()
